<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="../assets/css/header.css">
    <link rel="stylesheet" href="../assets/css/table.css">
</head>
<body>
    <header>
        <div class="container">
            <h1 class="logo"><a href="./home.html"><img src="../assets/images/logo.svg" alt="로고"></a></h1>
            <!-- 모바일 햄버거 버튼 -->
            <button class="menu-toggle"><img src="../assets/images/ic_menu.svg" alt="햄버거 메뉴"></button>

            <nav>
                <div class="mobile-menu-header">
                    <!-- 닫기 -->
                    <button class="close-btn"><img src="../assets/images/close.svg" alt=""></button>
                </div>

                <ul class="main-menu">
                    <!-- 해당 페이지 일때 li.active -->
                    <li class="display-pc"><a href="./home.html"><span>홈</span></a></li>
                    <li>
                        <a href="./notice_list.html"><span>공지 및 자료실</span><img class="toggle-open-icon"
                                src="../assets/images/chevron_Icon.svg" alt="열기"></a>
                        <ul class="sub-menu">
                            <li><a href="./notice_list.html">공지사항</a></li>
                            <li><a href="./guide_list.html">가이드 게시판</a></li>
                            <li><a href="./data_list.html">자료실</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="./faq_list.html"><span>사용 문의</span><img class="toggle-open-icon"
                                src="../assets/images/chevron_Icon.svg" alt="열기"></a>
                        <ul class="sub-menu">
                            <li><a href="./faq_list.html">자주 묻는 질문</a></li>
                            <li><a href="./qna_list.html">Q&A</a></li>
                        </ul>
                    </li>
                    <li class="display-pc">
                        <a href="./cp_request_list.html"><span>Cloud PC 관리</span><img class="toggle-open-icon"
                                src="../assets/images/chevron_Icon.svg" alt="열기"></a>
                        <ul class="sub-menu">
                            <li><a href="./cp_request_list.html">Cloud PC 작업 신청</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="./export_fail_down_list.html"><span>망연계 관리</span><img class="toggle-open-icon"
                                src="../assets/images/chevron_Icon.svg" alt="열기"></a>
                        <ul class="sub-menu">
                            <li><a href="./export_fail_down_list.html">반출 신청 파일 다운로드</a></li>
                            <li><a href="./url_redirection_list.html">URL Redirection</a></li>
                        </ul>
                    </li>
                </ul>
                <!-- 모바일 로그아웃 버튼 -->
                <button type="button" class="mo-btn-logout button">로그아웃</button>
            </nav>
            <div class="header-profile">
                <button type="button" class="btn-profile"><img src="../assets/images/ic_profile_52.svg"
                        alt="프로필"></button>
                <div class="hover-content">
                    <!-- PC 로그아웃 버튼 -->
                    <button type="button" class="btn-logout"><span>로그아웃</span><img
                            src="../assets/images/ic_logout_20.svg" alt="로그아웃"></button>
                </div>
            </div>
        </div>
    </header>
    <!-- 모바일 헤더 오버레이 -->
    <div class="overlay"></div>

    <article class="notice-list-page">
        <section class="page-title">
            <h2><img src="../assets/images/ic_qna.svg" alt="qna 아이콘"><strong>Q&A</strong></h2>
            <a href="./qna_write.html" class="button button-default">문의하기</a>
        </section>

        <section class="table-container">

            <div class="table-header-top">
                <!-- 탭 : 상태 -->
                <div class="tab-container">
                    <ul class="tabs">
                        <!-- 데이터가 여기에 동적으로 삽입됩니다 -->
                    </ul>
                </div>
                <!-- 검색 -->
                <div class="search-container">
                    <!-- 검색 타입 커스텀 셀렉트 -->
                    <div class="custom-select" id="searchTypeSelect">
                        <div class="select-selected">전체</div>
                        <div class="select-items select-hide">
                            <div data-value="all">전체</div>
                            <div data-value="title">제목</div>
                            <div data-value="content">내용</div>
                        </div>
                        <input type="hidden" id="searchType" value="all">
                    </div>
                    <input type="text" id="searchInput" placeholder="검색어를 입력하세요">
                    <button id="searchButton"><img src="../assets/images/ic_search_16.svg" alt="검색"></button>
                </div>
                <!-- 모바일 검색 버튼 -->
                <button class="search-button-toggle mo"><img src="../assets/images/ic_search_16.svg" alt="검색"></button>
            </div>


            <div class="table-header">
                <div class="total-count">총 <span id="totalCount">0</span>개</div>

                <!-- 정렬 타입 커스텀 셀렉트 -->
                <div class="custom-select sort-select" id="sortOrderSelect">
                    <div class="select-selected">최신순</div>
                    <div class="select-items select-hide">
                        <div data-value="newest">최신순</div>
                        <div data-value="oldest">오래된순</div>
                        <div data-value="views">조회순</div>
                    </div>
                    <input type="hidden" id="sortOrder" value="newest">
                </div>

            </div>


            <!-- 테이블 -->
            <div id="dataTable">
                <!-- pc:테이블 -->
                <table class="pc-table">
                    <colgroup>
                        <col style="width: 7%;">
                        <col style="width: 10%;">
                        <col style="width: 44%;">
                        <col style="width: 10%;">
                        <col style="width: 10%;">
                        <col style="width: 9%;">
                    </colgroup>
                    <thead>
                        <tr>
                            <th data-sort="number">번호</th>
                            <th data-sort="category">분류유형</th>
                            <th data-sort="title">제목</th>
                            <th data-sort="date">작성일</th>
                            <th data-sort="status">상태</th>
                            <th data-sort="views">조회수</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- 데이터가 여기에 동적으로 삽입됩니다 -->
                    </tbody>
                </table>

                <!-- mo: 카드 테이블 -->
                <div class="mo-card-table">
                    <div class="mo-table-body" id="moTableBody">
                        <!-- 동적 생성 -->
                    </div>
                </div>
            </div>

            <div class="pagination" id="pagination">
                <button id="firstPage"><img src="../assets/images/ic_table_prev_2.svg" alt="맨앞"></button>
                <button id="prevPage"><img src="../assets/images/ic_table_prev_1.svg" alt="이전"></button>
                <div id="pageNumbers" class="page-numbers">
                    <!-- 페이지 번호가 여기에 동적으로 삽입됩니다 -->
                </div>
                <button id="nextPage"><img src="../assets/images/ic_table_next1.svg" alt="다음"></button>
                <button id="lastPage"><img src="../assets/images/ic_table_next2.svg" alt="맨끝"></button>
            </div>
            </div>

        </section>
    </article>
    <script src="../assets/js/header.js"></script>
    <script src="../assets/js/loading_spinner.js"></script>
    <script src="../assets/js/table.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 게시판 데이터
            const qnaData = [
                { id: 1, category: '이용문의', title: '업무용 Cloud PC 자원 증설 문의 드립니다.', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 2, category: '이용문의', title: '사용자전 계정을 변경하려고 하는데 어떻게 변경하나요? 빠른 답변 부탁합니다.', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 3, category: '요금문의', title: '기업 PC를 홈오피스 이용하지 않는 중에도 비용이 발생하나요?', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 4, category: '요금문의', title: '기업 PC의 스펙을 변경할 수 있습니까?', date: '2025.02.14', status: '답변대기', views: 402 },
                { id: 5, category: '요금문의', title: '사용 라이선스를 가진 상용 솔루션(문서 솔루션)을 설치할 수 있습니까?', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 6, category: '이용문의', title: 'Cloud PC 사용 방법 안내', date: '2025.02.13', status: '답변완료', views: 320 },
                { id: 7, category: '장애문의', title: '인터넷 연결이 불안정합니다', date: '2025.02.12', status: '답변완료', views: 256 },
                { id: 8, category: '이용문의', title: '업무용 Cloud PC 자원 증설 문의 드립니다.', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 9, category: '이용문의', title: '사용자전 계정을 변경하려고 하는데 어떻게 변경하나요? 빠른 답변 부탁합니다.', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 10, category: '요금문의', title: '기업 PC를 홈오피스 이용하지 않는 중에도 비용이 발생하나요?', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 11, category: '요금문의', title: '기업 PC의 스펙을 변경할 수 있습니까?', date: '2025.02.14', status: '답변대기', views: 402 },
                { id: 12, category: '요금문의', title: '사용 라이선스를 가진 상용 솔루션(문서 솔루션)을 설치할 수 있습니까?', date: '2025.02.14', status: '답변완료', views: 402 },
                { id: 13, category: '이용문의', title: 'Cloud PC 사용 방법 안내', date: '2025.02.13', status: '답변완료', views: 320 },
                { id: 14, category: '장애문의', title: '인터넷 연결이 불안정합니다', date: '2025.02.12', status: '답변완료', views: 256 },
            ];

            /**
             * Q&A 데이터 렌더링 함수 (PC 테이블용)
             * @param {Array} data - 렌더링할 데이터 배열
             * @param {HTMLElement} tableBody - 테이블 바디 요소
             */
            function renderQnaData(data, tableBody) {
                tableBody.innerHTML = '';

                // 검색 결과가 없는 경우
                if (data.length === 0) {
                    const emptyRow = document.createElement('tr');
                    const emptyCell = document.createElement('td');

                    emptyCell.colSpan = 6; // 모든 컬럼을 병합
                    emptyCell.className = 'empty-message';
                    emptyCell.innerHTML = `
                <div class="search-no-result">
                    <p>문의하신 내역이 없습니다.<br><button type="button" class="button" onclick="location.href='./qna_write'">문의하기</button></p>
                </div>
            `;

                    emptyRow.appendChild(emptyCell);
                    tableBody.appendChild(emptyRow);
                    return;
                }

                data.forEach(item => {
                    const row = document.createElement('tr');

                    // 번호
                    const numberCell = document.createElement('td');
                    numberCell.textContent = item.id;
                    row.appendChild(numberCell);

                    // 분류
                    const categoryCell = document.createElement('td');
                    categoryCell.textContent = item.category;
                    row.appendChild(categoryCell);

                    // 제목
                    const titleCell = document.createElement('td');
                    titleCell.textContent = item.title;
                    titleCell.style.textAlign = 'left';
                    titleCell.style.cursor = 'pointer';

                    // 제목 클릭 이벤트 추가
                    titleCell.addEventListener('click', function () {
                        // 실제 구현 시 상세페이지로 이동하는 코드를 추가
                        //console.log(`게시글 ID ${item.id} 상세 페이지로 이동`);
                         window.location.href = `./qna_detail.html`;
                    });

                    row.appendChild(titleCell);

                    // 등록일
                    const dateCell = document.createElement('td');
                    dateCell.textContent = item.date;
                    row.appendChild(dateCell);

                    // 상태
                    const statusCell = document.createElement('td');
                    const statusSpan = document.createElement('span');

                    statusSpan.textContent = item.status;
                    statusCell.className = item.status === '답변완료' ? 'status-answered' : 'status-pending';
                    statusCell.appendChild(statusSpan);
                    row.appendChild(statusCell);

                    // 조회수
                    const viewsCell = document.createElement('td');
                    viewsCell.textContent = item.views;
                    row.appendChild(viewsCell);

                    tableBody.appendChild(row);
                });
            }

            /**
             * Q&A 모바일 카드 렌더링 함수
             * @param {Array} data - 렌더링할 데이터 배열
             * @param {HTMLElement} cardContainer - 카드 컨테이너 요소
             */
            function renderQnaMobileCards(data, cardContainer) {
                cardContainer.innerHTML = '';

                // 검색 결과가 없는 경우
                if (data.length === 0) {
                    cardContainer.innerHTML = `
                <div class="mo-no-result">
                    <div class="search-no-result">
                        <p>문의하신 내역이 없습니다.<br><button type="button" class="button" onclick="location.href='./qna_write'">문의하기</button></p>
                    </div>
                </div>
            `;
                    return;
                }

                // 각 데이터 아이템에 대해 카드 생성
                data.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card-item';

                    // 카드 헤더 (분류)
                    const cardHeader = document.createElement('div');
                    cardHeader.className = 'card-header';

                    // 분류
                    const category = document.createElement('div');
                    category.className = 'card-category';
                    category.textContent = item.category;

                    // 헤더에 분류 추가
                    cardHeader.appendChild(category);

                    // 카드 본문 (제목)
                    const cardBody = document.createElement('div');
                    cardBody.className = 'card-body';

                    // 제목
                    const title = document.createElement('div');
                    title.className = 'card-title';
                    title.textContent = item.title;

                    // 본문에 제목 추가
                    cardBody.appendChild(title);

                    // 카드 푸터 (날짜, 조회수, 상태)
                    const cardFooter = document.createElement('div');
                    cardFooter.className = 'card-footer';

                    // 정보 영역 (날짜, 조회수)
                    const infoArea = document.createElement('div');
                    infoArea.className = 'card-info';

                    // 날짜
                    const date = document.createElement('div');
                    date.className = 'card-date';
                    date.textContent = item.date;

                    // 조회수
                    const views = document.createElement('div');
                    views.className = 'card-views';
                    views.innerHTML = `<img src="../assets/images/ic_view.svg" alt="조회수"> ${item.views}`;

                    // 상태
                    const status = document.createElement('div');
                    status.className = item.status === '답변완료' ? 'status-answered' : 'status-pending';

                    const statusSpan = document.createElement('span');
                    statusSpan.textContent = item.status;
                    status.appendChild(statusSpan);

                    // 정보 영역에 날짜와 조회수, 상태 추가
                    infoArea.appendChild(date);
                    infoArea.appendChild(views);
                    infoArea.appendChild(status);

                    // 푸터에 정보 영역 추가
                    cardFooter.appendChild(infoArea);

                    // 클릭 이벤트 설정
                    cardBody.addEventListener('click', function () {
                        //console.log(`게시글 ID ${item.id} 상세 페이지로 이동`);
                        window.location.href = `./qna_detail.html`;
                    });

                    // 카드에 헤더와 본문, 푸터 추가
                    card.appendChild(cardHeader);
                    card.appendChild(cardBody);
                    card.appendChild(cardFooter);

                    // 컨테이너에 카드 추가
                    cardContainer.appendChild(card);
                });
            }

            // 1. 동적으로 상태(status) 탭 생성 - 공통 함수 사용
            createDynamicTabs(qnaData, 'status', document.querySelector('.tabs'));

            // 2. Q&A 페이지 전용 메시지 설정
            const qnaMessages = {
                emptyData: {
                    pc: `
                <div class="search-no-result">
                    <p>문의하신 내역이 없습니다.<br><button type="button" class="button" onclick="location.href='./qna_write'">문의하기</button></p>
                </div>
            `,
                    mobile: `
                <div class="search-no-result">
                    <p>문의하신 내역이 없습니다.<br><button type="button" class="button" onclick="location.href='./qna_write'">문의하기</button></p>
                </div>
            `
                },
                emptySearch: {
                    pc: `
                <div class="search-no-result">
                    <p>검색 결과가 존재하지 않습니다.<br>다른 검색어로 검색해보세요.</p>
                </div>
            `,
                    mobile: `
                <div class="search-no-result">
                    <p>검색 결과가 존재하지 않습니다.<br>다른 검색어로 검색해보세요.</p>
                </div>
            `
                }
            };

            // 3. 테이블 초기화 - 공통 테이블 모듈 사용
            const qnaTable = initializeTable({
                // 기본 데이터 설정
                data: qnaData,

                // 렌더링 콜백 함수
                renderCallback: renderQnaData,          // PC 테이블용 렌더링 함수
                renderMobileCallback: renderQnaMobileCards, // 모바일 카드 렌더링 함수

                // DOM 요소 ID
                tableBodyId: 'tableBody',               // PC 테이블 바디 ID
                moTableBodyId: 'moTableBody',           // 모바일 테이블 바디 ID
                totalCountId: 'totalCount',             // 총 항목 수 표시 요소 ID
                pageNumbersId: 'pageNumbers',           // 페이지 번호 컨테이너 ID

                // 페이지네이션 설정
                itemsPerPage: 10,                       // 페이지당 표시할 항목 수
                pageRange: 5,                           // 페이지 네비게이션에 표시할 페이지 번호 수

                // 정렬 설정
                sortConfig: {
                    defaultColumn: 'date',              // 기본 정렬 컬럼
                    defaultDirection: 'desc'            // 기본 정렬 방향 (최신순)
                },

                // 필터링 설정
                filterProperty: 'status',               // 필터링 속성 (상태)

                // 메시지 설정
                messages: qnaMessages                   // 페이지별 커스텀 메시지
            });

            // 4. 테이블 초기화 실행
            qnaTable.init();
        });
    </script>
</body>
</html>