<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="../assets/css/header.css">
    <link rel="stylesheet" href="../assets/css/info_message.css">
</head>

<body class="bg_none">
    <header class="login-header">
        <h1><a href="/"><img src="../assets/images/logo.svg" alt="로고"></a></h1>
    </header>

    <article class="info-message-page req_check">
       <section class="container">
        <div class="title">
            <h2>
                <img src="../assets//images/ic__warn.svg" alt="icon">
                초기 설치 파일 다운
            </h2>
              <span>서비스 이용을 위해 <br class="mo">필수 설치 파일을 먼저 다운로드해 주세요.<br>
                해당 파일을 설치하지 않으면 <br class="mo">로그인 및 기능 이용이 제한됩니다.</span>
            </div>
            <div class="req_contents">
                <ul>
                    <li>
                        <div class="action_button windows">
                            <img class="logo-icon" src="../assets/images/windows_logo.svg" alt="윈도우 로고">
                            <strong>Windows 사용자용</strong>
                            <button type="button" class="btn-control-icon"><img src="../assets/images/chevron_Icon.svg"
                                    alt="아이콘"></button>
                        </div>
                        <!-- 설치됨 : .btn-complete / 미설치 : btn-incomplete -->
                        <div class="show_content">
                            <ul>
                                <li>접속 Agent <a href="#" class="btn-down btn-complete">설치됨 <img
                                            src="../assets/images/icon_complete.svg" alt="다운로드"></a></li>
                                <li>포탈 Agent <a href="#" class="btn-down btn-incomplete">미설치 <img
                                            src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (업무용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                            src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (개인 PC용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>설치 가이드 <a href="#" class="btn-down btn-complete">설치됨 <img src="../assets/images/icon_complete.svg"
                                            alt="다운로드"></a></li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <div class="action_button mac">
                            <img class="logo-icon" src="../assets/images/mac_logo.svg" alt="맥 로고">
                            <strong>Mac 사용자용</strong>
                            <button type="button" class="btn-control-icon"><img src="../assets/images/chevron_Icon.svg"
                                    alt="아이콘"></button>
                        </div>
                        <div class="show_content">
                            <ul>
                                <li>접속 Agent <a href="#" class="btn-down btn-complete">설치됨 <img
                                    src="../assets/images/icon_complete.svg" alt="다운로드"></a></li>
                                <li>포탈 Agent <a href="#" class="btn-down btn-complete">설치됨 <img
                                    src="../assets/images/icon_complete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (업무용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (개인 PC용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>설치 가이드 <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <div class="action_button tablet">
                            <img class="logo-icon" src="../assets/images/tablet_icon.svg" alt="테블릿 아이콘">
                            <strong>Tablet 사용자용</strong>
                            <button type="button" class="btn-control-icon"><img src="../assets/images/chevron_Icon.svg"
                                    alt="아이콘"></button>
                        </div>
                        <div class="show_content">
                            <ul>
                                <li>접속 Agent <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>포탈 Agent <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (업무용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>망연계 Agent (개인 PC용) <a href="#" class="btn-down btn-incomplete">미설치 <img
                                    src="../assets/images/icon_incomplete.svg" alt="다운로드"></a></li>
                                <li>설치 가이드 <a href="#" class="btn-down btn-complete">설치됨 <img
                                    src="../assets/images/icon_complete.svg" alt="다운로드"></a></li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="bottom-wrap">
                <button type="button" class="button button-cancel">이전</button>
                <button type="button" id="btnCheckreq" class="button button-default">설치확인</button>
            </div>
       </section>
    </article>
    <script src="../assets/js/loading_spinner.js"></script>
    <script>

    document.getElementById('btnCheckreq').addEventListener('click', () => {
        LoadingSpinner.init({
            textColor: 'rgba(46, 47, 51, 0.88)',
            defaultText: '설치파일 확인 중 입니다.'
        });
        LoadingSpinner.show();
        setTimeout(() => {
            LoadingSpinner.hide();
            window.location.href = '../index.html'
        }, 1000);
    });

    // 초기 설치 프로그램 다운로드
    const actionButtons = document.querySelectorAll('.action_button');
    // 화면 너비 감지
    const windowWidth = window.innerWidth;

    // 디바이스 타입 감지 함수 (PC vs 모바일/태블릿)
    function detectDeviceType() {
        const userAgent = navigator.userAgent.toLowerCase();
        // 터치 기능 감지
        const hasTouchScreen = ('ontouchstart' in window) || 
                            (navigator.maxTouchPoints > 0) || 
                            (navigator.msMaxTouchPoints > 0);
        
        // 아이패드 감지를 위한 추가 체크
        const isIPad = /ipad/.test(userAgent) || 
                    (userAgent.includes('mac') && hasTouchScreen) ||
                    (userAgent.includes('macintosh') && hasTouchScreen);
        
        if (isIPad || /android|webos|iphone|ipod|blackberry|iemobile|opera mini/i.test(userAgent)) {
            return 'Mobile';
        } else {
            return 'Desktop';
        }
    }

    // PC OS 감지 함수
    function detectOS() {
        const userAgent = navigator.userAgent.toLowerCase();
        const platform = navigator.platform.toLowerCase();
        
        if (userAgent.indexOf('win') !== -1 || platform.indexOf('win') !== -1) {
            return 'Windows';
        } else if (userAgent.indexOf('mac') !== -1 || platform.indexOf('mac') !== -1) {
            return 'MacOS';
        } else {
            return 'Other OS';
        }
    }

    // 모바일 OS 감지 함수
    function detectMobileOS() {
        const userAgent = navigator.userAgent.toLowerCase();
        const hasTouchScreen = ('ontouchstart' in window) || 
                            (navigator.maxTouchPoints > 0) || 
                            (navigator.msMaxTouchPoints > 0);
        
        // 아이패드 감지를 위한 추가 체크
        const isIPad = /ipad/.test(userAgent) || 
                    (userAgent.includes('mac') && hasTouchScreen) ||
                    (userAgent.includes('macintosh') && hasTouchScreen);
        
        if (userAgent.indexOf('android') !== -1) {
            return 'Android';
        } else if (
            userAgent.indexOf('iphone') !== -1 ||
            isIPad ||
            userAgent.indexOf('ipod') !== -1
        ) {
            return 'iOS';
        } else {
            return 'Other';
        }
    }

    // 디바이스 타입과 OS 감지
    const deviceType = detectDeviceType();
    const currentOS = (deviceType === 'Mobile') ? detectMobileOS() : detectOS();

    // 디버깅을 위한 로그
    console.log('감지된 디바이스 타입:', deviceType);
    console.log('감지된 OS:', currentOS);
    console.log('화면 너비:', windowWidth);

    // 모든 show_content 요소 초기화 (모든 메뉴 접기)
    function closeAllContents() {
        document.querySelectorAll('.show_content').forEach(el => {
            el.classList.remove('show');
        });
        
        document.querySelectorAll('.btn-control-icon').forEach(el => {
            el.classList.remove('active');
        });
    }

    // 초기 상태 설정 - 모든 콘텐츠 닫기
    closeAllContents();

    // 윈도우 
    if (currentOS === 'Windows' && windowWidth > 1079) {
        document.querySelector('.action_button.windows').nextElementSibling.classList.add('show');
        document.querySelector('.action_button.windows .btn-control-icon').classList.add('active');
        console.log('윈도우용 값 설정');
    // 맥
    } else if (currentOS === 'MacOS' && windowWidth > 1079) {
        document.querySelector('.action_button.mac').nextElementSibling.classList.add('show');
        document.querySelector('.action_button.mac .btn-control-icon').classList.add('active');
        console.log('맥OS용 값 설정');
    // 모바일/태블릿
    } else if (deviceType === 'Mobile' || windowWidth <= 1079) {
        document.querySelector('.action_button.tablet').nextElementSibling.classList.add('show');
        document.querySelector('.action_button.tablet .btn-control-icon').classList.add('active');
        console.log('태블릿/모바일 값 설정');
        
        // 필요한 경우 iOS/Android 구분
        // if (currentOS === 'Android') {
        //     console.log('안드로이드용 값 설정');
        // } else if (currentOS === 'iOS') {
        //     console.log('iOS용 값 설정');
        // }
    // 그 외 경우 윈도우로 처리
    } else {
        document.querySelector('.action_button.windows').nextElementSibling.classList.add('show');
        document.querySelector('.action_button.windows .btn-control-icon').classList.add('active');
        console.log('기타 OS - 윈도우용 값 설정');
    }

    // 각 버튼 클릭 이벤트 설정
    actionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            // 현재 클릭한 버튼의 콘텐츠
            const content = this.nextElementSibling;
            // 현재 클릭한 버튼의 아이콘
            const icon = this.querySelector('.btn-control-icon');
            
            // 이미 열려있는 상태인지 확인
            const isAlreadyOpen = content.classList.contains('show');
            
            // 모든 컨텐츠와 아이콘 초기화
            closeAllContents();
            
            // 닫혀있던 경우에만 열기 (이미 열려있던 경우 닫힘 상태 유지)
            if (!isAlreadyOpen) {
                content.classList.add('show');
                icon.classList.add('active');
            }
            
            // 이벤트 버블링 방지
            e.stopPropagation();
        });
    });

    // 페이지 클릭 시 모든 메뉴 닫기 (옵션)
    document.addEventListener('click', function(e) {
        // 클릭한 요소가 .action_button 또는 그 하위 요소가 아닌 경우에만 모든 메뉴 닫기
        if (!e.target.closest('.action_button') && !e.target.closest('.show_content')) {
            closeAllContents();
        }
    });
    </script>
</body>

</html>